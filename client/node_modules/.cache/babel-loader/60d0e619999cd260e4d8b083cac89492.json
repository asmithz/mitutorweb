{"ast":null,"code":"var _jsxFileName = \"/home/asmith/test-taller/taller/proyecto1/proyecto-taller/client/src/components/chat/ChatVirtual.js\",\n    _s = $RefreshSig$();\n\nimport './ChatVirtual.css';\nimport { Formik, Form, Field, ErrorMessage, isObject } from 'formik';\nimport BotonFormulario from '../botones/BotonFormulario';\nimport ModalPago from '../botones/ModalPago';\nimport io from 'socket.io-client';\nimport ObtenerUsuarioID from '../controllers/ObtenerUsuarioID';\nimport { useEffect, useState } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport axios from 'axios';\nimport DetectarTipoUsuario from '../controllers/DetectarTipoUsuario';\nimport ScrollableFeed from 'react-scrollable-feed';\nimport APIZoom from './APIZoom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst socket = io('http://localhost:2000/');\nsocket.on(\"connection\");\nconst api = axios.create({\n  withCredentials: true,\n  credentials: 'include',\n  baseURL: `http://localhost:2000/api/mensajeControlador`\n});\nconst api_chat = axios.create({\n  withCredentials: true,\n  credentials: 'include',\n  baseURL: `http://localhost:2000/api/chatControlador`\n});\nconst api_pago = axios.create({\n  withCredentials: true,\n  credentials: 'include',\n  baseURL: `http://localhost:2000/api/pagoControlador`\n});\n\nconst ChatVirtual = props => {\n  _s();\n\n  const emisorID = ObtenerUsuarioID();\n  const emisorTIPO = DetectarTipoUsuario().tipo;\n  const datos_reunion = APIZoom();\n  const chatID = useLocation().pathname.split(\"/\")[2];\n  const [chatDatos, setchatDatos] = useState({});\n  const [mensajes, setMensajes] = useState([]);\n  const [montoTotal, setMonto] = useState(0);\n  const [enlacePago, setEnlace] = useState(\"\");\n\n  const enviarMensaje = async mensajeRequest => {\n    const mi_token = localStorage.getItem('x-token');\n    const mensaje = Object.values(mensajeRequest)[0];\n    const mensajeEnviado = {\n      'emisor_id': emisorID,\n      mensaje\n    };\n\n    try {\n      const response = await api.post(\"/enviarMensaje/\" + chatID, mensajeEnviado, {\n        headers: {\n          'Content-type': 'application/json',\n          'x-token': mi_token\n        }\n      });\n      const response_chat = await api_chat.get(\"/verificarChat/\" + chatID, {\n        headers: {\n          'Content-type': 'application/json',\n          'x-token': mi_token\n        }\n      });\n\n      if (response_chat.data.chat) {\n        setchatDatos(response_chat.data);\n        socket.emit(\"mensaje\", chatDatos, mensajeEnviado, emisorID);\n        socket.on(\"mensaje\", mensajeEnviado => {\n          setMensajes([...mensajes, mensajeEnviado]);\n        });\n      }\n    } catch (error) {\n      alert(\"El chat ya no existe, fue borrado.\");\n      window.location.replace('/Bandeja');\n      console.log(error);\n    }\n  };\n\n  useEffect(() => {\n    const mostrarMensajes = async () => {\n      const mi_token = localStorage.getItem('x-token');\n\n      try {\n        const response = await api.get(\"/obtenerMensajes/\" + chatID, {\n          headers: {\n            'Content-type': 'application/json',\n            'x-token': mi_token\n          }\n        });\n\n        if (response.data.mensajes) {\n          setMensajes(response.data.mensajes);\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    };\n\n    mostrarMensajes();\n  }, [mensajes]);\n\n  const solicitarEnlace = () => {\n    console.log(datos_reunion);\n    return alert(\"El enlace de la reunión es: \" + datos_reunion.response.join_url + \"\\nLa contraseña de la reunión es: \" + datos_reunion.response.password + \"\\nDuración: 1 Hora\");\n  };\n\n  const salirChat = () => {\n    window.location.replace('/Bandeja');\n  };\n\n  const generarPago = async () => {\n    if (!montoTotal || montoTotal === 0) {\n      alert(\"Monto inválido, intente denuevo\");\n    } else {\n      const datos = {\n        \"monto\": montoTotal,\n        \"tutor_id\": emisorID,\n        \"estado\": \"Pendiente\"\n      };\n      const mi_token = localStorage.getItem('x-token');\n\n      try {\n        const iniciar_pago = await api_pago.post(\"/generarPago\", datos, {\n          headers: {\n            'Content-type': 'application/json',\n            'x-token': mi_token\n          }\n        });\n\n        if (iniciar_pago.data.nuevo_pago) {\n          setEnlace(\"http://localhost:3000/PagoEnLinea/\" + iniciar_pago.data.nuevo_pago._id);\n          socket.emit(\"enlace_pago\", chatDatos, enlacePago, emisorID);\n          socket.on(\"enlace_pago\", enlacePago => {\n            setMensajes([...mensajes, enlacePago]);\n          });\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 13\n    }, this), emisorTIPO === \"estudiante\" && /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Chat Virtual con su tutor\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 17\n    }, this), emisorTIPO === \"tutor\" && /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Chat Virtual con su estudiante\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-tarjeta\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mensajes\",\n        children: /*#__PURE__*/_jsxDEV(ScrollableFeed, {\n          children: mensajes.map((mensajeEnviado, i) => {\n            if (emisorID === mensajeEnviado.emisor_id) {\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mensaje-emisor\",\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"max1\",\n                  children: mensajeEnviado.mensaje\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 148,\n                  columnNumber: 37\n                }, this)\n              }, i, false, {\n                fileName: _jsxFileName,\n                lineNumber: 147,\n                columnNumber: 40\n              }, this);\n            } else {\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mensaje-receptor\",\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"max1\",\n                  children: mensajeEnviado.mensaje\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 154,\n                  columnNumber: 37\n                }, this)\n              }, i, false, {\n                fileName: _jsxFileName,\n                lineNumber: 153,\n                columnNumber: 40\n              }, this);\n            }\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-bottom\",\n        children: [emisorTIPO === \"tutor\" && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"boton-aceptar\",\n            \"data-bs-toggle\": \"modal\",\n            nombre: \"boton\",\n            \"data-bs-target\": \"#exampleModall\",\n            \"data-bs-whatever\": \"@mdo\",\n            children: \"Zoom\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"modal fade\",\n            id: \"exampleModall\",\n            tabindex: \"-1\",\n            \"aria-labelledby\": \"exampleModalLabell\",\n            \"aria-hidden\": \"true\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"modal-dialog\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                class: \"modal-content\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  class: \"modal-header\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                    class: \"modal-title\",\n                    id: \"exampleModalLabell\",\n                    children: \"Enlace de Zoom generado con \\xE9xito\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 170,\n                    columnNumber: 33\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    type: \"button\",\n                    class: \"btn-close\",\n                    \"data-bs-dismiss\": \"modal\",\n                    \"aria-label\": \"Close\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 171,\n                    columnNumber: 33\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 169,\n                  columnNumber: 29\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  class: \"modal-body\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    class: \"mb-4\",\n                    children: [datos_reunion.response === undefined && /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false), datos_reunion.response !== undefined && /*#__PURE__*/_jsxDEV(_Fragment, {\n                      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                        for: \"recipient-name\",\n                        class: \"col-form-label\",\n                        children: [\"Enlace: \", datos_reunion.response.join_url, \" \"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 181,\n                        columnNumber: 37\n                      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                        for: \"recipient-name\",\n                        class: \"col-form-label\",\n                        children: [\"Contrase\\xF1a: \", datos_reunion.response.password]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 182,\n                        columnNumber: 37\n                      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                        for: \"recipient-name\",\n                        class: \"col-form-label\",\n                        children: [\"Duraci\\xF3n: \", datos_reunion.response.duration]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 183,\n                        columnNumber: 37\n                      }, this)]\n                    }, void 0, true)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 174,\n                    columnNumber: 33\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 173,\n                  columnNumber: 29\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 168,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 167,\n              columnNumber: 25\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true), emisorTIPO === \"estudiante\" && /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false), /*#__PURE__*/_jsxDEV(Formik, {\n          initialValues: {\n            mensaje: ''\n          },\n          onSubmit: (values, {\n            resetForm\n          }) => {\n            enviarMensaje(values);\n            resetForm({\n              values: \"\"\n            });\n          },\n          children: /*#__PURE__*/_jsxDEV(Form, {\n            children: [emisorTIPO === \"tutor\" && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"chat-input-mensaje-tutor\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-floating\",\n                children: [/*#__PURE__*/_jsxDEV(Field, {\n                  placeholder: \"Escriba un mensaje\",\n                  className: \"form-control\",\n                  id: \"floatingMensaje\",\n                  name: \"mensaje\",\n                  type: \"text\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 207,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                  for: \"floatingNombre\",\n                  children: \"Escriba un mensaje\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 208,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(ErrorMessage, {\n                  name: \"mensaje\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 209,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 206,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(BotonFormulario, {\n                  className: \"btn btn-primary\",\n                  nombre: \"boton\",\n                  value: \"Enviar mensaje\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 212,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 211,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 33\n            }, this), emisorTIPO === \"estudiante\" && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"chat-input-mensaje-estudiante\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-floating\",\n                children: [/*#__PURE__*/_jsxDEV(Field, {\n                  placeholder: \"Escriba un mensaje\",\n                  className: \"form-control\",\n                  id: \"floatingMensaje\",\n                  name: \"mensaje\",\n                  type: \"text\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 220,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                  for: \"floatingNombre\",\n                  children: \"Escriba un mensaje\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 221,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(ErrorMessage, {\n                  name: \"mensaje\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 222,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 219,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(BotonFormulario, {\n                  type: \"reset\",\n                  className: \"btn btn-primary\",\n                  nombre: \"boton\",\n                  value: \"Enviar mensaje\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 225,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 224,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 218,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 17\n      }, this), emisorTIPO === \"tutor\" && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"boton-aceptar\",\n          \"data-bs-toggle\": \"modal\",\n          func: props.func,\n          nombre: \"boton\",\n          \"data-bs-target\": \"#exampleModal\",\n          \"data-bs-whatever\": \"@mdo\",\n          children: \"Generar Pago\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"modal fade\",\n          id: \"exampleModal\",\n          tabindex: \"-1\",\n          \"aria-labelledby\": \"exampleModalLabel\",\n          \"aria-hidden\": \"true\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"modal-dialog\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"modal-content\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                class: \"modal-header\",\n                children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                  class: \"modal-title\",\n                  id: \"exampleModalLabel\",\n                  children: \"Generar enlace de pago\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 240,\n                  columnNumber: 33\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  class: \"btn-close\",\n                  \"data-bs-dismiss\": \"modal\",\n                  \"aria-label\": \"Close\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 241,\n                  columnNumber: 33\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                class: \"modal-body\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  class: \"mb-3\",\n                  children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                    for: \"recipient-name\",\n                    class: \"col-form-label\",\n                    children: \"Valor de la tutor\\xEDa:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 245,\n                    columnNumber: 37\n                  }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                    placeholder: \"Ingrese el monto\",\n                    type: \"text\",\n                    class: \"form-control\",\n                    id: \"recipient-name\",\n                    onChange: e => setMonto(e.target.value)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 246,\n                    columnNumber: 37\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 244,\n                  columnNumber: 33\n                }, this), enlacePago !== \"\" && /*#__PURE__*/_jsxDEV(\"div\", {\n                  class: \"mb-3\",\n                  children: /*#__PURE__*/_jsxDEV(\"label\", {\n                    for: \"recipient-name\",\n                    class: \"col-form-label\",\n                    children: [\"Su enlace de pago es el siguiente \", enlacePago]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 251,\n                    columnNumber: 41\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 250,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 243,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                class: \"modal-footer\",\n                children: [enlacePago !== \"\" && /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  class: \"btn btn-secondary\",\n                  \"data-bs-dismiss\": \"modal\",\n                  onClick: () => setEnlace(\"\"),\n                  children: \"Cerrar\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 258,\n                  columnNumber: 37\n                }, this), enlacePago === \"\" && /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  class: \"boton-aceptar\",\n                  onClick: generarPago,\n                  children: \"Generar\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 262,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 255,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 238,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(BotonFormulario, {\n      className: \"boton-eliminar\",\n      nombre: \"salir\",\n      func: salirChat,\n      value: \"Salir del chat\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 131,\n    columnNumber: 9\n  }, this);\n};\n\n_s(ChatVirtual, \"Sar/IYkLCYZC1yM1zSXyM4TsGAk=\", false, function () {\n  return [useLocation];\n});\n\n_c = ChatVirtual;\nexport default ChatVirtual;\n\nvar _c;\n\n$RefreshReg$(_c, \"ChatVirtual\");","map":{"version":3,"sources":["/home/asmith/test-taller/taller/proyecto1/proyecto-taller/client/src/components/chat/ChatVirtual.js"],"names":["Formik","Form","Field","ErrorMessage","isObject","BotonFormulario","ModalPago","io","ObtenerUsuarioID","useEffect","useState","useLocation","axios","DetectarTipoUsuario","ScrollableFeed","APIZoom","socket","on","api","create","withCredentials","credentials","baseURL","api_chat","api_pago","ChatVirtual","props","emisorID","emisorTIPO","tipo","datos_reunion","chatID","pathname","split","chatDatos","setchatDatos","mensajes","setMensajes","montoTotal","setMonto","enlacePago","setEnlace","enviarMensaje","mensajeRequest","mi_token","localStorage","getItem","mensaje","Object","values","mensajeEnviado","response","post","headers","response_chat","get","data","chat","emit","error","alert","window","location","replace","console","log","mostrarMensajes","solicitarEnlace","join_url","password","salirChat","generarPago","datos","iniciar_pago","nuevo_pago","_id","map","i","emisor_id","undefined","duration","resetForm","func","e","target","value"],"mappings":";;;AAAA,OAAO,mBAAP;AACA,SAASA,MAAT,EAAiBC,IAAjB,EAAuBC,KAAvB,EAA8BC,YAA9B,EAA4CC,QAA5C,QAA4D,QAA5D;AACA,OAAOC,eAAP,MAA4B,4BAA5B;AACA,OAAOC,SAAP,MAAsB,sBAAtB;AACA,OAAOC,EAAP,MAAe,kBAAf;AACA,OAAOC,gBAAP,MAA6B,iCAA7B;AACA,SAASC,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,mBAAP,MAAgC,oCAAhC;AACA,OAAOC,cAAP,MAA2B,uBAA3B;AACA,OAAOC,OAAP,MAAoB,WAApB;;;AAEA,MAAMC,MAAM,GAAGT,EAAE,CAAC,wBAAD,CAAjB;AACAS,MAAM,CAACC,EAAP,CAAU,YAAV;AAEA,MAAMC,GAAG,GAAGN,KAAK,CAACO,MAAN,CAAa;AACvBC,EAAAA,eAAe,EAAE,IADM;AAEvBC,EAAAA,WAAW,EAAE,SAFU;AAGvBC,EAAAA,OAAO,EAAG;AAHa,CAAb,CAAZ;AAMA,MAAMC,QAAQ,GAAGX,KAAK,CAACO,MAAN,CAAa;AAC5BC,EAAAA,eAAe,EAAE,IADW;AAE5BC,EAAAA,WAAW,EAAE,SAFe;AAG5BC,EAAAA,OAAO,EAAG;AAHkB,CAAb,CAAjB;AAMA,MAAME,QAAQ,GAAGZ,KAAK,CAACO,MAAN,CAAa;AAC5BC,EAAAA,eAAe,EAAE,IADW;AAE5BC,EAAAA,WAAW,EAAE,SAFe;AAG5BC,EAAAA,OAAO,EAAG;AAHkB,CAAb,CAAjB;;AAMA,MAAMG,WAAW,GAAIC,KAAD,IAAW;AAAA;;AAC3B,QAAMC,QAAQ,GAAGnB,gBAAgB,EAAjC;AACA,QAAMoB,UAAU,GAAGf,mBAAmB,GAAGgB,IAAzC;AACA,QAAMC,aAAa,GAAGf,OAAO,EAA7B;AACA,QAAMgB,MAAM,GAAGpB,WAAW,GAAGqB,QAAd,CAAuBC,KAAvB,CAA6B,GAA7B,EAAkC,CAAlC,CAAf;AACA,QAAM,CAACC,SAAD,EAAYC,YAAZ,IAA4BzB,QAAQ,CAAC,EAAD,CAA1C;AACA,QAAM,CAAC0B,QAAD,EAAWC,WAAX,IAA0B3B,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAAC4B,UAAD,EAAaC,QAAb,IAAyB7B,QAAQ,CAAC,CAAD,CAAvC;AACA,QAAM,CAAC8B,UAAD,EAAaC,SAAb,IAA0B/B,QAAQ,CAAC,EAAD,CAAxC;;AAEA,QAAMgC,aAAa,GAAG,MAAOC,cAAP,IAA0B;AAC5C,UAAMC,QAAQ,GAAGC,YAAY,CAACC,OAAb,CAAqB,SAArB,CAAjB;AACA,UAAMC,OAAO,GAAGC,MAAM,CAACC,MAAP,CAAcN,cAAd,EAA8B,CAA9B,CAAhB;AACA,UAAMO,cAAc,GAAG;AAAC,mBAAavB,QAAd;AAAwBoB,MAAAA;AAAxB,KAAvB;;AACA,QAAG;AACC,YAAMI,QAAQ,GAAG,MAAMjC,GAAG,CAACkC,IAAJ,CAAS,oBAAkBrB,MAA3B,EAAmCmB,cAAnC,EAAmD;AACtEG,QAAAA,OAAO,EAAE;AACL,0BAAgB,kBADX;AAEL,qBAAWT;AAFN;AAD6D,OAAnD,CAAvB;AAKA,YAAMU,aAAa,GAAG,MAAM/B,QAAQ,CAACgC,GAAT,CAAa,oBAAkBxB,MAA/B,EAAuC;AAC/DsB,QAAAA,OAAO,EAAE;AACL,0BAAgB,kBADX;AAEL,qBAAWT;AAFN;AADsD,OAAvC,CAA5B;;AAMA,UAAGU,aAAa,CAACE,IAAd,CAAmBC,IAAtB,EAA2B;AACvBtB,QAAAA,YAAY,CAACmB,aAAa,CAACE,IAAf,CAAZ;AACAxC,QAAAA,MAAM,CAAC0C,IAAP,CAAY,SAAZ,EAAuBxB,SAAvB,EAAkCgB,cAAlC,EAAkDvB,QAAlD;AACAX,QAAAA,MAAM,CAACC,EAAP,CAAU,SAAV,EAAsBiC,cAAD,IAAoB;AACrCb,UAAAA,WAAW,CAAC,CAAC,GAAGD,QAAJ,EAAcc,cAAd,CAAD,CAAX;AACH,SAFD;AAGH;AACJ,KAnBD,CAmBC,OAAMS,KAAN,EAAY;AACTC,MAAAA,KAAK,CAAC,oCAAD,CAAL;AACAC,MAAAA,MAAM,CAACC,QAAP,CAAgBC,OAAhB,CAAwB,UAAxB;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAYN,KAAZ;AACH;AACJ,GA5BD;;AA8BAlD,EAAAA,SAAS,CAAC,MAAM;AACZ,UAAMyD,eAAe,GAAG,YAAY;AAChC,YAAMtB,QAAQ,GAAGC,YAAY,CAACC,OAAb,CAAqB,SAArB,CAAjB;;AACA,UAAG;AACC,cAAMK,QAAQ,GAAG,MAAMjC,GAAG,CAACqC,GAAJ,CAAQ,sBAAoBxB,MAA5B,EAAoC;AACvDsB,UAAAA,OAAO,EAAE;AACL,4BAAgB,kBADX;AAEL,uBAAWT;AAFN;AAD8C,SAApC,CAAvB;;AAKA,YAAGO,QAAQ,CAACK,IAAT,CAAcpB,QAAjB,EAA0B;AACtBC,UAAAA,WAAW,CAACc,QAAQ,CAACK,IAAT,CAAcpB,QAAf,CAAX;AACH;AACJ,OATD,CASC,OAAMuB,KAAN,EAAY;AACTK,QAAAA,OAAO,CAACC,GAAR,CAAYN,KAAZ;AACH;AACJ,KAdD;;AAeAO,IAAAA,eAAe;AACd,GAjBI,EAiBF,CAAC9B,QAAD,CAjBE,CAAT;;AAmBA,QAAM+B,eAAe,GAAG,MAAM;AAC1BH,IAAAA,OAAO,CAACC,GAAR,CAAYnC,aAAZ;AACA,WAAO8B,KAAK,CAAC,iCAA+B9B,aAAa,CAACqB,QAAd,CAAuBiB,QAAtD,GAA+D,oCAA/D,GAAoGtC,aAAa,CAACqB,QAAd,CAAuBkB,QAA3H,GAAoI,oBAArI,CAAZ;AACH,GAHD;;AAKA,QAAMC,SAAS,GAAG,MAAM;AACpBT,IAAAA,MAAM,CAACC,QAAP,CAAgBC,OAAhB,CAAwB,UAAxB;AACH,GAFD;;AAIA,QAAMQ,WAAW,GAAG,YAAW;AAC3B,QAAG,CAACjC,UAAD,IAAeA,UAAU,KAAK,CAAjC,EAAmC;AAC/BsB,MAAAA,KAAK,CAAC,iCAAD,CAAL;AACH,KAFD,MAGI;AACA,YAAMY,KAAK,GAAG;AAAC,iBAASlC,UAAV;AAAsB,oBAAYX,QAAlC;AAA4C,kBAAU;AAAtD,OAAd;AACA,YAAMiB,QAAQ,GAAGC,YAAY,CAACC,OAAb,CAAqB,SAArB,CAAjB;;AACA,UAAG;AACC,cAAM2B,YAAY,GAAG,MAAMjD,QAAQ,CAAC4B,IAAT,CAAc,cAAd,EAA8BoB,KAA9B,EAAqC;AAC5DnB,UAAAA,OAAO,EAAE;AACL,4BAAgB,kBADX;AAEL,uBAAWT;AAFN;AADmD,SAArC,CAA3B;;AAMA,YAAG6B,YAAY,CAACjB,IAAb,CAAkBkB,UAArB,EAAgC;AAC5BjC,UAAAA,SAAS,CAAC,uCAAqCgC,YAAY,CAACjB,IAAb,CAAkBkB,UAAlB,CAA6BC,GAAnE,CAAT;AACA3D,UAAAA,MAAM,CAAC0C,IAAP,CAAY,aAAZ,EAA2BxB,SAA3B,EAAsCM,UAAtC,EAAkDb,QAAlD;AACAX,UAAAA,MAAM,CAACC,EAAP,CAAU,aAAV,EAA0BuB,UAAD,IAAgB;AACrCH,YAAAA,WAAW,CAAC,CAAC,GAAGD,QAAJ,EAAcI,UAAd,CAAD,CAAX;AACH,WAFD;AAGH;AACJ,OAdD,CAcC,OAAMmB,KAAN,EAAY;AACTK,QAAAA,OAAO,CAACC,GAAR,CAAYN,KAAZ;AACH;AACJ;AACJ,GAzBD;;AA2BA,sBACI;AAAA,4BACI;AAAA;AAAA;AAAA;AAAA,YADJ,EAGQ/B,UAAU,KAAK,YAAf,iBACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAJR,EAOQA,UAAU,KAAK,OAAf,iBACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YARR,eAUI;AAAK,MAAA,SAAS,EAAC,cAAf;AAAA,8BACI;AAAK,QAAA,SAAS,EAAC,UAAf;AAAA,+BACI,QAAC,cAAD;AAAA,oBAEGQ,QAAQ,CAACwC,GAAT,CAAa,CAAC1B,cAAD,EAAiB2B,CAAjB,KAAuB;AAChC,gBAAGlD,QAAQ,KAAKuB,cAAc,CAAC4B,SAA/B,EAAyC;AACpC,kCAAO;AAAK,gBAAA,SAAS,EAAC,gBAAf;AAAA,uCACH;AAAG,kBAAA,SAAS,EAAC,MAAb;AAAA,4BAAqB5B,cAAc,CAACH;AAApC;AAAA;AAAA;AAAA;AAAA;AADG,iBAAqC8B,CAArC;AAAA;AAAA;AAAA;AAAA,sBAAP;AAIJ,aALD,MAMI;AACC,kCAAO;AAAK,gBAAA,SAAS,EAAC,kBAAf;AAAA,uCACH;AAAG,kBAAA,SAAS,EAAC,MAAb;AAAA,4BAAqB3B,cAAc,CAACH;AAApC;AAAA;AAAA;AAAA;AAAA;AADG,iBAAuC8B,CAAvC;AAAA;AAAA;AAAA;AAAA,sBAAP;AAGJ;AACJ,WAZD;AAFH;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,cADJ,eAoBI;AAAK,QAAA,SAAS,EAAC,aAAf;AAAA,mBAEQjD,UAAU,KAAK,OAAf,iBACA;AAAA,kCACA;AAAQ,YAAA,IAAI,EAAC,QAAb;AAAsB,YAAA,SAAS,EAAC,eAAhC;AAAgD,8BAAe,OAA/D;AAAuE,YAAA,MAAM,EAAC,OAA9E;AAAsF,8BAAe,gBAArG;AAAsH,gCAAiB,MAAvI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADA,eAEA;AAAK,YAAA,KAAK,EAAC,YAAX;AAAwB,YAAA,EAAE,EAAC,eAA3B;AAA2C,YAAA,QAAQ,EAAC,IAApD;AAAyD,+BAAgB,oBAAzE;AAA8F,2BAAY,MAA1G;AAAA,mCACA;AAAK,cAAA,KAAK,EAAC,cAAX;AAAA,qCACI;AAAK,gBAAA,KAAK,EAAC,eAAX;AAAA,wCACA;AAAK,kBAAA,KAAK,EAAC,cAAX;AAAA,0CACI;AAAI,oBAAA,KAAK,EAAC,aAAV;AAAwB,oBAAA,EAAE,EAAC,oBAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADJ,eAEI;AAAQ,oBAAA,IAAI,EAAC,QAAb;AAAsB,oBAAA,KAAK,EAAC,WAA5B;AAAwC,uCAAgB,OAAxD;AAAgE,kCAAW;AAA3E;AAAA;AAAA;AAAA;AAAA,0BAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,wBADA,eAKA;AAAK,kBAAA,KAAK,EAAC,YAAX;AAAA,yCACI;AAAK,oBAAA,KAAK,EAAC,MAAX;AAAA,+BACKE,aAAa,CAACqB,QAAd,KAA2B4B,SAA3B,iBACD,qCAFJ,EAKKjD,aAAa,CAACqB,QAAd,KAA2B4B,SAA3B,iBACD;AAAA,8CACA;AAAO,wBAAA,GAAG,EAAC,gBAAX;AAA4B,wBAAA,KAAK,EAAC,gBAAlC;AAAA,+CAA4DjD,aAAa,CAACqB,QAAd,CAAuBiB,QAAnF;AAAA;AAAA;AAAA;AAAA;AAAA,8BADA,eAEA;AAAO,wBAAA,GAAG,EAAC,gBAAX;AAA4B,wBAAA,KAAK,EAAC,gBAAlC;AAAA,sDAAgEtC,aAAa,CAACqB,QAAd,CAAuBkB,QAAvF;AAAA;AAAA;AAAA;AAAA;AAAA,8BAFA,eAGA;AAAO,wBAAA,GAAG,EAAC,gBAAX;AAA4B,wBAAA,KAAK,EAAC,gBAAlC;AAAA,oDAA8DvC,aAAa,CAACqB,QAAd,CAAuB6B,QAArF;AAAA;AAAA;AAAA;AAAA;AAAA,8BAHA;AAAA,oCANJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,wBALA;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA,kBAFA;AAAA,wBAHR,EAkCQpD,UAAU,KAAK,YAAf,iBACA,qCAnCR,eAqCI,QAAC,MAAD;AAAQ,UAAA,aAAa,EAAE;AACnBmB,YAAAA,OAAO,EAAE;AADU,WAAvB;AAGA,UAAA,QAAQ,EAAE,CAACE,MAAD,EAAS;AAACgC,YAAAA;AAAD,WAAT,KAAyB;AAACvC,YAAAA,aAAa,CAACO,MAAD,CAAb;AAAuBgC,YAAAA,SAAS,CAAC;AAAChC,cAAAA,MAAM,EAAE;AAAT,aAAD,CAAT;AAAwB,WAHnF;AAAA,iCAII,QAAC,IAAD;AAAA,uBAEQrB,UAAU,KAAK,OAAf,iBACA;AAAK,cAAA,SAAS,EAAC,0BAAf;AAAA,sCACI;AAAK,gBAAA,SAAS,EAAC,eAAf;AAAA,wCACI,QAAC,KAAD;AAAO,kBAAA,WAAW,EAAC,oBAAnB;AAAwC,kBAAA,SAAS,EAAC,cAAlD;AAAiE,kBAAA,EAAE,EAAC,iBAApE;AAAsF,kBAAA,IAAI,EAAC,SAA3F;AAAqG,kBAAA,IAAI,EAAC;AAA1G;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI;AAAO,kBAAA,GAAG,EAAC,gBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFJ,eAGI,QAAC,YAAD;AAAc,kBAAA,IAAI,EAAC;AAAnB;AAAA;AAAA;AAAA;AAAA,wBAHJ;AAAA;AAAA;AAAA;AAAA;AAAA,sBADJ,eAMI;AAAA,uCACI,QAAC,eAAD;AAAiB,kBAAA,SAAS,EAAC,iBAA3B;AAA6C,kBAAA,MAAM,EAAC,OAApD;AAA4D,kBAAA,KAAK,EAAC;AAAlE;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,sBANJ;AAAA;AAAA;AAAA;AAAA;AAAA,oBAHR,EAeQA,UAAU,KAAK,YAAf,iBACA;AAAK,cAAA,SAAS,EAAC,+BAAf;AAAA,sCACI;AAAK,gBAAA,SAAS,EAAC,eAAf;AAAA,wCACI,QAAC,KAAD;AAAO,kBAAA,WAAW,EAAC,oBAAnB;AAAwC,kBAAA,SAAS,EAAC,cAAlD;AAAiE,kBAAA,EAAE,EAAC,iBAApE;AAAsF,kBAAA,IAAI,EAAC,SAA3F;AAAqG,kBAAA,IAAI,EAAC;AAA1G;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI;AAAO,kBAAA,GAAG,EAAC,gBAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAFJ,eAGI,QAAC,YAAD;AAAc,kBAAA,IAAI,EAAC;AAAnB;AAAA;AAAA;AAAA;AAAA,wBAHJ;AAAA;AAAA;AAAA;AAAA;AAAA,sBADJ,eAMI;AAAA,uCACI,QAAC,eAAD;AAAiB,kBAAA,IAAI,EAAC,OAAtB;AAA8B,kBAAA,SAAS,EAAC,iBAAxC;AAA0D,kBAAA,MAAM,EAAC,OAAjE;AAAyE,kBAAA,KAAK,EAAC;AAA/E;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,sBANJ;AAAA;AAAA;AAAA;AAAA;AAAA,oBAhBR;AAAA;AAAA;AAAA;AAAA;AAAA;AAJJ;AAAA;AAAA;AAAA;AAAA,gBArCJ;AAAA;AAAA;AAAA;AAAA;AAAA,cApBJ,EA4FIA,UAAU,KAAK,OAAf,iBACR;AAAA,gCACgB;AAAQ,UAAA,IAAI,EAAC,QAAb;AAAsB,UAAA,SAAS,EAAC,eAAhC;AAAgD,4BAAe,OAA/D;AAAuE,UAAA,IAAI,EAAEF,KAAK,CAACwD,IAAnF;AAAyF,UAAA,MAAM,EAAC,OAAhG;AAAwG,4BAAe,eAAvH;AAAuI,8BAAiB,MAAxJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADhB,eAEgB;AAAK,UAAA,KAAK,EAAC,YAAX;AAAwB,UAAA,EAAE,EAAC,cAA3B;AAA0C,UAAA,QAAQ,EAAC,IAAnD;AAAwD,6BAAgB,mBAAxE;AAA4F,yBAAY,MAAxG;AAAA,iCACA;AAAK,YAAA,KAAK,EAAC,cAAX;AAAA,mCACI;AAAK,cAAA,KAAK,EAAC,eAAX;AAAA,sCACA;AAAK,gBAAA,KAAK,EAAC,cAAX;AAAA,wCACI;AAAI,kBAAA,KAAK,EAAC,aAAV;AAAwB,kBAAA,EAAE,EAAC,mBAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADJ,eAEI;AAAQ,kBAAA,IAAI,EAAC,QAAb;AAAsB,kBAAA,KAAK,EAAC,WAA5B;AAAwC,qCAAgB,OAAxD;AAAgE,gCAAW;AAA3E;AAAA;AAAA;AAAA;AAAA,wBAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,sBADA,eAKA;AAAK,gBAAA,KAAK,EAAC,YAAX;AAAA,wCACI;AAAK,kBAAA,KAAK,EAAC,MAAX;AAAA,0CACI;AAAO,oBAAA,GAAG,EAAC,gBAAX;AAA4B,oBAAA,KAAK,EAAC,gBAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADJ,eAEI;AAAO,oBAAA,WAAW,EAAC,kBAAnB;AAAsC,oBAAA,IAAI,EAAC,MAA3C;AAAkD,oBAAA,KAAK,EAAC,cAAxD;AAAuE,oBAAA,EAAE,EAAC,gBAA1E;AAA2F,oBAAA,QAAQ,EAAEC,CAAC,IAAI5C,QAAQ,CAAC4C,CAAC,CAACC,MAAF,CAASC,KAAV;AAAlH;AAAA;AAAA;AAAA;AAAA,0BAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,wBADJ,EAMQ7C,UAAU,KAAK,EAAf,iBACA;AAAK,kBAAA,KAAK,EAAC,MAAX;AAAA,yCACI;AAAO,oBAAA,GAAG,EAAC,gBAAX;AAA4B,oBAAA,KAAK,EAAC,gBAAlC;AAAA,qEAAsFA,UAAtF;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,wBAPR;AAAA;AAAA;AAAA;AAAA;AAAA,sBALA,eAiBA;AAAK,gBAAA,KAAK,EAAC,cAAX;AAAA,2BAEQA,UAAU,KAAK,EAAf,iBACA;AAAQ,kBAAA,IAAI,EAAC,QAAb;AAAsB,kBAAA,KAAK,EAAC,mBAA5B;AAAgD,qCAAgB,OAAhE;AAAwE,kBAAA,OAAO,EAAE,MAAMC,SAAS,CAAC,EAAD,CAAhG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAHR,EAMQD,UAAU,KAAK,EAAf,iBACA;AAAQ,kBAAA,IAAI,EAAC,QAAb;AAAsB,kBAAA,KAAK,EAAC,eAA5B;AAA4C,kBAAA,OAAO,EAAE+B,WAArD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAPR;AAAA;AAAA;AAAA;AAAA;AAAA,sBAjBA;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA,gBAFhB;AAAA,sBA7FI;AAAA;AAAA;AAAA;AAAA;AAAA,YAVJ,eA4II,QAAC,eAAD;AAAiB,MAAA,SAAS,EAAC,gBAA3B;AAA4C,MAAA,MAAM,EAAC,OAAnD;AAA2D,MAAA,IAAI,EAAED,SAAjE;AAA4E,MAAA,KAAK,EAAC;AAAlF;AAAA;AAAA;AAAA;AAAA,YA5IJ;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ;AAgJH,CA/OD;;GAAM7C,W;UAIad,W;;;KAJbc,W;AAiPN,eAAeA,WAAf","sourcesContent":["import './ChatVirtual.css'\nimport { Formik, Form, Field, ErrorMessage, isObject } from 'formik';\nimport BotonFormulario from '../botones/BotonFormulario';\nimport ModalPago from '../botones/ModalPago'\nimport io from 'socket.io-client'\nimport ObtenerUsuarioID from '../controllers/ObtenerUsuarioID';\nimport { useEffect, useState } from 'react';\nimport { useLocation } from 'react-router-dom'\nimport axios from 'axios'\nimport DetectarTipoUsuario from '../controllers/DetectarTipoUsuario';\nimport ScrollableFeed from 'react-scrollable-feed'\nimport APIZoom from './APIZoom'\n\nconst socket = io('http://localhost:2000/')\nsocket.on(\"connection\")\n\nconst api = axios.create({\n  withCredentials: true, \n  credentials: 'include',\n  baseURL: `http://localhost:2000/api/mensajeControlador`\n})\n\nconst api_chat = axios.create({\n  withCredentials: true, \n  credentials: 'include',\n  baseURL: `http://localhost:2000/api/chatControlador`\n})\n\nconst api_pago = axios.create({\n  withCredentials: true, \n  credentials: 'include',\n  baseURL: `http://localhost:2000/api/pagoControlador`\n})\n\nconst ChatVirtual = (props) => {\n    const emisorID = ObtenerUsuarioID()\n    const emisorTIPO = DetectarTipoUsuario().tipo\n    const datos_reunion = APIZoom()\n    const chatID = useLocation().pathname.split(\"/\")[2]\n    const [chatDatos, setchatDatos] = useState({})\n    const [mensajes, setMensajes] = useState([])\n    const [montoTotal, setMonto] = useState(0)\n    const [enlacePago, setEnlace] = useState(\"\")\n\n    const enviarMensaje = async (mensajeRequest) => {\n        const mi_token = localStorage.getItem('x-token')\n        const mensaje = Object.values(mensajeRequest)[0]\n        const mensajeEnviado = {'emisor_id': emisorID, mensaje}\n        try{\n            const response = await api.post(\"/enviarMensaje/\"+chatID, mensajeEnviado, {\n                headers: {\n                    'Content-type': 'application/json',\n                    'x-token': mi_token\n                }})\n            const response_chat = await api_chat.get(\"/verificarChat/\"+chatID, {\n                headers: {\n                    'Content-type': 'application/json',\n                    'x-token': mi_token\n                }\n            })\n            if(response_chat.data.chat){\n                setchatDatos(response_chat.data)\n                socket.emit(\"mensaje\", chatDatos, mensajeEnviado, emisorID)\n                socket.on(\"mensaje\", (mensajeEnviado) => {\n                    setMensajes([...mensajes, mensajeEnviado])\n                })\n            }\n        }catch(error){\n            alert(\"El chat ya no existe, fue borrado.\")\n            window.location.replace('/Bandeja');\n            console.log(error)\n        }\n    }\n\n    useEffect(() => {\n        const mostrarMensajes = async () => {\n            const mi_token = localStorage.getItem('x-token')\n            try{\n                const response = await api.get(\"/obtenerMensajes/\"+chatID, {\n                    headers: {\n                        'Content-type': 'application/json',\n                        'x-token': mi_token\n                    }})\n                if(response.data.mensajes){\n                    setMensajes(response.data.mensajes)\n                }\n            }catch(error){\n                console.log(error)\n            }\n        }\n        mostrarMensajes()\n        }, [mensajes])\n\n    const solicitarEnlace = () => {\n        console.log(datos_reunion)\n        return alert(\"El enlace de la reunión es: \"+datos_reunion.response.join_url+\"\\nLa contraseña de la reunión es: \"+datos_reunion.response.password+\"\\nDuración: 1 Hora\")\n    }\n\n    const salirChat = () => {\n        window.location.replace('/Bandeja');\n    }\n\n    const generarPago = async () =>{\n        if(!montoTotal || montoTotal === 0){\n            alert(\"Monto inválido, intente denuevo\")\n        }\n        else{\n            const datos = {\"monto\": montoTotal, \"tutor_id\": emisorID, \"estado\": \"Pendiente\"} \n            const mi_token = localStorage.getItem('x-token')\n            try{\n                const iniciar_pago = await api_pago.post(\"/generarPago\", datos, {\n                    headers: {\n                        'Content-type': 'application/json',\n                        'x-token': mi_token\n                    }\n                })\n                if(iniciar_pago.data.nuevo_pago){\n                    setEnlace(\"http://localhost:3000/PagoEnLinea/\"+iniciar_pago.data.nuevo_pago._id)\n                    socket.emit(\"enlace_pago\", chatDatos, enlacePago, emisorID)\n                    socket.on(\"enlace_pago\", (enlacePago) => {\n                        setMensajes([...mensajes, enlacePago])\n                    })\n                }\n            }catch(error){\n                console.log(error)\n            }\n        }\n    }\n\n    return(\n        <div>\n            <br/>\n            {\n                emisorTIPO === \"estudiante\" &&\n                <h1>Chat Virtual con su tutor</h1>\n            }\n            {\n                emisorTIPO === \"tutor\" &&\n                <h1>Chat Virtual con su estudiante</h1>\n            } \n            <div className=\"chat-tarjeta\">\n                <div className=\"mensajes\">\n                    <ScrollableFeed>\n                    {\n                       mensajes.map((mensajeEnviado, i) => {\n                           if(emisorID === mensajeEnviado.emisor_id){\n                                return <div className=\"mensaje-emisor\" key={i}>\n                                    <p className=\"max1\">{mensajeEnviado.mensaje}</p>\n                                </div>\n\n                           }\n                           else{\n                                return <div className=\"mensaje-receptor\" key={i}>\n                                    <p className=\"max1\">{mensajeEnviado.mensaje}</p>\n                                        </div>\n                           }\n                       }) \n                    }\n                    </ScrollableFeed>\n                </div>\n                <div className=\"chat-bottom\">\n                    {\n                        emisorTIPO === \"tutor\" &&\n                        <>\n                        <button type=\"button\" className=\"boton-aceptar\" data-bs-toggle=\"modal\" nombre=\"boton\" data-bs-target=\"#exampleModall\" data-bs-whatever=\"@mdo\">Zoom</button>\n                        <div class=\"modal fade\" id=\"exampleModall\" tabindex=\"-1\" aria-labelledby=\"exampleModalLabell\" aria-hidden=\"true\">\n                        <div class=\"modal-dialog\">\n                            <div class=\"modal-content\">\n                            <div class=\"modal-header\">\n                                <h5 class=\"modal-title\" id=\"exampleModalLabell\">Enlace de Zoom generado con éxito</h5>\n                                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                            </div>\n                            <div class=\"modal-body\">\n                                <div class=\"mb-4\">\n                                    {datos_reunion.response === undefined &&\n                                    <>\n                                    </>\n                                    }\n                                    {datos_reunion.response !== undefined &&\n                                    <>\n                                    <label for=\"recipient-name\" class=\"col-form-label\">Enlace: {datos_reunion.response.join_url} </label>\n                                    <label for=\"recipient-name\" class=\"col-form-label\">Contraseña: {datos_reunion.response.password}</label>\n                                    <label for=\"recipient-name\" class=\"col-form-label\">Duración: {datos_reunion.response.duration}</label>\n                                    </>\n                                    }\n                                </div>\n                            </div>\n                            \n                            </div>\n                        </div>\n                        </div>\n                        </>\n                    }\n                    {\n                        emisorTIPO === \"estudiante\" &&\n                        <></>\n                    }\n                    <Formik initialValues={{\n                        mensaje: ''\n                    }}\n                    onSubmit={(values, {resetForm}) => {enviarMensaje(values); resetForm({values: \"\"})}}>\n                        <Form>\n                            {\n                                emisorTIPO === \"tutor\" &&\n                                <div className=\"chat-input-mensaje-tutor\">\n                                    <div className=\"form-floating\">\n                                        <Field placeholder=\"Escriba un mensaje\" className=\"form-control\" id=\"floatingMensaje\" name=\"mensaje\" type=\"text\"/>\n                                        <label for=\"floatingNombre\">Escriba un mensaje</label>\n                                        <ErrorMessage name=\"mensaje\"/>\n                                    </div>\n                                    <div>\n                                        <BotonFormulario className=\"btn btn-primary\" nombre=\"boton\" value=\"Enviar mensaje\"/>\n                                    </div>\n                                </div>\n                            }\n                            {\n                                emisorTIPO === \"estudiante\" &&\n                                <div className=\"chat-input-mensaje-estudiante\">\n                                    <div className=\"form-floating\">\n                                        <Field placeholder=\"Escriba un mensaje\" className=\"form-control\" id=\"floatingMensaje\" name=\"mensaje\" type=\"text\"/>\n                                        <label for=\"floatingNombre\">Escriba un mensaje</label>\n                                        <ErrorMessage name=\"mensaje\"/>\n                                    </div>\n                                    <div>\n                                        <BotonFormulario type=\"reset\" className=\"btn btn-primary\" nombre=\"boton\" value=\"Enviar mensaje\"/>\n                                    </div>\n                                </div>\n                            }\n                        </Form>\n                    </Formik>\n                </div>\n                {\n                emisorTIPO === \"tutor\" &&\n        <>\n                        <button type=\"button\" className=\"boton-aceptar\" data-bs-toggle=\"modal\" func={props.func} nombre=\"boton\" data-bs-target=\"#exampleModal\" data-bs-whatever=\"@mdo\">Generar Pago</button>\n                        <div class=\"modal fade\" id=\"exampleModal\" tabindex=\"-1\" aria-labelledby=\"exampleModalLabel\" aria-hidden=\"true\">\n                        <div class=\"modal-dialog\">\n                            <div class=\"modal-content\">\n                            <div class=\"modal-header\">\n                                <h5 class=\"modal-title\" id=\"exampleModalLabel\">Generar enlace de pago</h5>\n                                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                            </div>\n                            <div class=\"modal-body\">\n                                <div class=\"mb-3\">\n                                    <label for=\"recipient-name\" class=\"col-form-label\">Valor de la tutoría:</label>\n                                    <input placeholder=\"Ingrese el monto\" type=\"text\" class=\"form-control\" id=\"recipient-name\" onChange={e => setMonto(e.target.value)}/>\n                                </div>\n                                {\n                                    enlacePago !== \"\" &&\n                                    <div class=\"mb-3\">\n                                        <label for=\"recipient-name\" class=\"col-form-label\">Su enlace de pago es el siguiente {enlacePago}</label>\n                                    </div>\n                                }\n                            </div>\n                            <div class=\"modal-footer\">\n                                {\n                                    enlacePago !== \"\" &&\n                                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\" onClick={() => setEnlace(\"\")} >Cerrar</button>\n                                }\n                                {\n                                    enlacePago === \"\" &&\n                                    <button type=\"button\" class=\"boton-aceptar\" onClick={generarPago}>Generar</button>\n                                }\n                            </div>\n                            </div>\n                        </div>\n                        </div>\n        </>\n                }\n            </div>\n            <BotonFormulario className=\"boton-eliminar\" nombre=\"salir\" func={salirChat} value=\"Salir del chat\"/>\n        </div>\n    );\n}\n\nexport default ChatVirtual;"]},"metadata":{},"sourceType":"module"}